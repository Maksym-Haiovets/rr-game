(()=>{"use strict";async function t(t){const e=await fetch(`${t}`);if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);return e.json()}async function e(t,e){const i=await fetch(`${t}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!i.ok)throw new Error(`HTTP error! status: ${i.status}`);return i.json()}function i(t,e="success"){const i=document.getElementById("toast-container")||function(){const t=document.createElement("div");return t.id="toast-container",t.className="toast-container",document.body.appendChild(t),t}(),s=document.createElement("div");s.className=`toast ${e}`,s.textContent=t,i.appendChild(s),setTimeout(()=>{s.style.animation="toastSlideOut 0.3s ease forwards",setTimeout(()=>{s.parentNode&&s.parentNode.removeChild(s)},300)},3e3)}const s=[{id:"breakeven",title:"–ë–µ–∑–∑–±–∏—Ç–∫–æ–≤—ñ",description:"5 —Ç–µ–π–∫—ñ–≤ + 10 —Å—Ç–æ–ø—ñ–≤ = 0% –ø—Ä–∏–±—É—Ç–∫—É",minProfit:0,takes:5,stops:10,minWinRate:33.3,color:"#ffd93d",emoji:"‚öñÔ∏è"},{id:"light",title:"–õ–µ–≥–∫–∏–π –ø—Ä–∏–±—É—Ç–æ–∫",description:"6 —Ç–µ–π–∫—ñ–≤ + 9 —Å—Ç–æ–ø—ñ–≤ = 3% –ø—Ä–∏–±—É—Ç–∫—É",minProfit:3,takes:6,stops:9,minWinRate:40,color:"#06d6a0",emoji:"üå±"},{id:"good",title:"–•–æ—Ä–æ—à–∏–π –ø—Ä–∏–±—É—Ç–æ–∫",description:"7 —Ç–µ–π–∫—ñ–≤ + 8 —Å—Ç–æ–ø—ñ–≤ = 6% –ø—Ä–∏–±—É—Ç–∫—É",minProfit:6,takes:7,stops:8,minWinRate:45,color:"#10b981",emoji:"üíö"},{id:"excellent",title:"–í—ñ–¥–º—ñ–Ω–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫",description:"8 —Ç–µ–π–∫—ñ–≤ + 7 —Å—Ç–æ–ø—ñ–≤ = 9% –ø—Ä–∏–±—É—Ç–∫—É",minProfit:9,takes:8,stops:7,minWinRate:50,color:"#8b5cf6",emoji:"üíé"},{id:"amazing",title:"–ù–µ–π–º–æ–≤—ñ—Ä–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫",description:"9 —Ç–µ–π–∫—ñ–≤ + 6 —Å—Ç–æ–ø—ñ–≤ = 12% –ø—Ä–∏–±—É—Ç–∫—É",minProfit:12,takes:9,stops:6,minWinRate:60,color:"#f59e0b",emoji:"üöÄ"}];const a=[{title:"–í—ñ—Ç–∞—î–º–æ –≤ –≥—Ä—ñ!",text:"–¶–µ –≥—Ä–∞ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è —Ä–∏–∑–∏–∫-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç—É –≤ —Ç—Ä–µ–π–¥–∏–Ω–≥—É. –í–∏ –±—É–¥–µ—Ç–µ —Å–∏–º—É–ª—é–≤–∞—Ç–∏ —Ç–æ—Ä–≥–æ–≤—ñ –ø–æ–∑–∏—Ü—ñ—ó —Ç–∞ –¥–∏–≤–∏—Ç–∏—Å—è –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏."},{title:"–¢–æ—Ä–≥–æ–≤—ñ –ø–æ–∑–∏—Ü—ñ—ó",text:"–ö–æ–∂–Ω–∞ –∫–ª—ñ—Ç–∏–Ω–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—î —Ç–æ—Ä–≥–æ–≤—É –ø–æ–∑–∏—Ü—ñ—é. –ö–ª—ñ–∫–∞–π—Ç–µ –ø–æ –Ω–∏—Ö, —â–æ–± –ø–æ–∑–Ω–∞—á–∏—Ç–∏ —è–∫ —Ç–µ–π–∫ (–ø—Ä–∏–±—É—Ç–æ–∫) –∞–±–æ —Å—Ç–æ–ø (–∑–±–∏—Ç–æ–∫).",target:"#positions-grid"},{title:"–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞",text:"–¢—É—Ç –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î—Ç—å—Å—è –≤–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–µ–π–∫—ñ–≤, —Å—Ç–æ–ø—ñ–≤, –∑–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫ —Ç–∞ win-rate.",target:".stats-panel"},{title:"–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è",text:"–¢—É—Ç –≤–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ä–∏–∑–∏–∫ –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é —Ç–∞ —Å–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –ø—Ä–∏–±—É—Ç–∫—É (RR).",target:".settings-section"},{title:"–ì—Ä–∞–¥–∞—Ü—ñ—ó –ø—Ä–∏–±—É—Ç–∫—É",text:"–°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∑—É—î –≤–∞—à –ø—Ä–æ–≥—Ä–µ—Å —á–µ—Ä–µ–∑ —Ä—ñ–∑–Ω—ñ —Ä—ñ–≤–Ω—ñ –ø—Ä–∏–±—É—Ç–∫–æ–≤–æ—Å—Ç—ñ.",target:".profit-grades-section"},{title:"–ì–æ—Ç–æ–≤–æ!",text:"–¢–µ–ø–µ—Ä –≤–∏ –∑–Ω–∞—î—Ç–µ –æ—Å–Ω–æ–≤–∏. –ü–æ—á–Ω—ñ—Ç—å –∫–ª—ñ–∫–∞—Ç–∏ –ø–æ –ø–æ–∑–∏—Ü—ñ—è—Ö —Ç–∞ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞–π—Ç–µ –∑–∞ —Å–≤–æ—ó–º–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏!"}],n=new class{constructor(){this.currentStep=0}start(){this.currentStep=0,this.createOverlay(),this.showStep()}createOverlay(){this.overlay=document.createElement("div"),this.overlay.className="tutorial-overlay",this.overlay.style.cssText="\n      position: fixed;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      background: rgba(0, 0, 0, 0.7);\n      z-index: 9999;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n    ",this.modal=document.createElement("div"),this.modal.className="tutorial-modal",this.modal.style.cssText="\n      background: var(--surface-color);\n      padding: 2rem;\n      border-radius: 16px;\n      max-width: 500px;\n      margin: 1rem;\n      text-align: center;\n      border: 1px solid var(--border-color);\n      box-shadow: var(--shadow-lg);\n    ",this.overlay.appendChild(this.modal),document.body.appendChild(this.overlay)}showStep(){const t=a[this.currentStep];t&&this.modal&&(this.highlightTarget(t.target),this.modal.innerHTML=`\n      <h3 style="margin-bottom: 1rem; font-size: 1.25rem; font-weight: 700;">${t.title}</h3>\n      <p style="margin-bottom: 2rem; color: var(--text-muted);">${t.text}</p>\n      <div style="display: flex; gap: 1rem; justify-content: center;">\n        ${this.currentStep>0?'<button id="tutorial-prev" class="btn btn-secondary">–ù–∞–∑–∞–¥</button>':""}\n        <button id="tutorial-next" class="btn btn-primary">\n          ${this.currentStep===a.length-1?"–ó–∞–≤–µ—Ä—à–∏—Ç–∏":"–î–∞–ª—ñ"}\n        </button>\n        <button id="tutorial-skip" class="btn btn-outline">–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏</button>\n      </div>\n    `,this.modal.querySelector("#tutorial-next")?.addEventListener("click",()=>{this.currentStep===a.length-1?this.finish():this.next()}),this.modal.querySelector("#tutorial-prev")?.addEventListener("click",()=>{this.prev()}),this.modal.querySelector("#tutorial-skip")?.addEventListener("click",()=>{this.finish()}),t.action&&t.action())}highlightTarget(t){if(document.querySelectorAll(".tutorial-highlight").forEach(t=>{t.classList.remove("tutorial-highlight")}),t){const e=document.querySelector(t);if(e&&(e.classList.add("tutorial-highlight"),!document.querySelector("#tutorial-highlight-style"))){const t=document.createElement("style");t.id="tutorial-highlight-style",t.textContent="\n            .tutorial-highlight {\n              position: relative;\n              z-index: 10000;\n              box-shadow: 0 0 0 4px var(--primary-color), 0 0 0 8px rgba(139, 92, 246, 0.3) !important;\n              border-radius: 8px !important;\n            }\n          ",document.head.appendChild(t)}}}next(){this.currentStep++,this.showStep()}prev(){this.currentStep--,this.showStep()}finish(){this.overlay&&document.body.removeChild(this.overlay),document.querySelectorAll(".tutorial-highlight").forEach(t=>{t.classList.remove("tutorial-highlight")});const t=document.querySelector("#tutorial-highlight-style");t&&t.remove(),i("–¢—É—Ç–æ—Ä—ñ–∞–ª –∑–∞–≤–µ—Ä—à–µ–Ω–æ!","success")}};class o{constructor(){this.gameState={positions:[],settings:{id:1,risk_per_position:1,reward_ratio:2,tutorial_completed:!1,tutorial_skipped_forever:!1},stats:{takes:0,stops:0,profit:0,winRate:0}}}async init(){try{this.initTheme(),await this.loadGameState(),this.setupUI(),this.checkTutorial(),console.log("‚úÖ –ì—Ä–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —É—Å–ø—ñ—à–Ω–æ")}catch(t){console.error("‚ùå –ü–æ–º–∏–ª–∫–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—ó –≥—Ä–∏:",t),i("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≥—Ä–∏","error")}}initTheme(){const t=localStorage.getItem("theme")||"light",e=window.matchMedia("(prefers-color-scheme: dark)").matches,i="auto"===t?e?"dark":"light":t;document.documentElement.setAttribute("data-theme",i),this.updateThemeToggle(i)}toggleTheme(){const t="light"===document.documentElement.getAttribute("data-theme")?"dark":"light";document.documentElement.setAttribute("data-theme",t),localStorage.setItem("theme",t),this.updateThemeToggle(t)}updateThemeToggle(t){const e=document.getElementById("theme-toggle");e&&(e.innerHTML="light"===t?"üåô":"‚òÄÔ∏è",e.setAttribute("aria-label","light"===t?"Switch to dark mode":"Switch to light mode"))}async loadGameState(){try{const[e,i]=await Promise.all([t("/api/positions"),t("/api/settings")]);this.gameState.positions=e,this.gameState.settings=i,this.calculateStats()}catch(t){throw console.error("–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–∞–Ω—É –≥—Ä–∏:",t),t}}setupUI(){this.createPositionsGrid(),this.updateStatsDisplay(),this.updateSettingsUI(),this.setupEventListeners()}createPositionsGrid(){const t=document.getElementById("positions-grid");t.innerHTML="",this.gameState.positions.forEach(e=>{const i=document.createElement("div");i.className=`position-card ${e.result}`,i.textContent=e.id.toString(),i.dataset.id=e.id.toString(),i.addEventListener("click",()=>this.handlePositionClick(e.id)),t.appendChild(i)})}async handlePositionClick(t){try{const i=this.gameState.positions.find(e=>e.id===t);if(!i)return;const s=["none","take","stop"],a=s.indexOf(i.result),n=s[(a+1)%s.length];await e(`/api/positions/${t}`,{result:n}),i.result=n,document.querySelector(`[data-id="${t}"]`).className=`position-card ${n}`,this.calculateStats(),this.updateStatsDisplay()}catch(t){console.error("–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ—ó:",t),i("–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ—ó","error")}}calculateStats(){const t=this.gameState.positions.filter(t=>"take"===t.result).length,e=this.gameState.positions.filter(t=>"stop"===t.result).length,i=t+e,s=t*this.gameState.settings.reward_ratio+-1*e,a=i>0?t/i*100:0;this.gameState.stats={takes:t,stops:e,profit:parseFloat(s.toFixed(1)),winRate:parseFloat(a.toFixed(1))}}updateStatsDisplay(){document.getElementById("takes-count").textContent=this.gameState.stats.takes.toString(),document.getElementById("stops-count").textContent=this.gameState.stats.stops.toString(),document.getElementById("profit-pct").textContent=`${this.gameState.stats.profit}%`,document.getElementById("win-rate").textContent=`${this.gameState.stats.winRate}%`,function(t){const e=document.getElementById("profit-grades-list"),i=document.getElementById("current-level-display");i.classList.remove("current"),e.innerHTML="";let a=function(t){return s.reverse().find(e=>t>=e.takes)||null}(t);s.reverse().forEach(i=>{const s=document.createElement("div");s.className="profit-grade-item";const n=t>=i.takes,o=i.id===a?.id;n&&(s.classList.add("achieved"),a=i),o&&s.classList.add("current"),s.innerHTML=`\n      <div class="grade-header">\n        <span class="grade-title">${i.emoji} ${i.title}</span>\n        <span class="grade-percentage">${i.minProfit}%+</span>\n      </div>\n      <div class="grade-requirement">–ú—ñ–Ω—ñ–º—É–º ${i.minProfit}% –ø—Ä–∏–±—É—Ç–∫—É</div>\n      <div class="grade-winrate">Win-rate: ${i.minWinRate}%+</div>\n      <div class="grade-winrate">Win-rate: ${i.description}</div>\n    `,e.appendChild(s)}),a?(i.textContent=`–ü–æ—Ç–æ—á–Ω–∏–π —Ä—ñ–≤–µ–Ω—å: ${a.title}`,i.className=`current-level-display.grade-${a.id}`):(i.textContent="–ü–æ—Ç–æ—á–Ω–∏–π —Ä—ñ–≤–µ–Ω—å: –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å",i.className="current-level-display.initial")}(this.gameState.stats.takes,this.gameState.stats.stops,this.gameState.stats.profit),this.updateMotivationMessage()}updateMotivationMessage(){const t=document.getElementById("motivation-msg"),{takes:e,stops:i,profit:s}=this.gameState.stats;t.textContent=0===e&&0===i?"–ü–æ—á–Ω—ñ—Ç—å —Ç–æ—Ä–≥—É–≤–∞—Ç–∏, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏!":0===s&&5===e&&10===i?"‚öñÔ∏è –Ü–¥–µ–∞–ª—å–Ω–∞ –±–µ–∑–∑–±–∏—Ç–∫–æ–≤—ñ—Å—Ç—å! –¢–µ–ø–µ—Ä —Å–ø—Ä–æ–±—É–π—Ç–µ –¥–æ—Å—è–≥—Ç–∏ –ø—Ä–∏–±—É—Ç–∫—É.":s>0?`üí∞ –ß—É–¥–æ–≤–æ! –í–∏ –≤ –ø—Ä–∏–±—É—Ç–∫—É ${s}%. –ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —É —Ç–æ–º—É –∂ –¥—É—Å—ñ!`:s<0?"üìâ –ù–µ –ø–µ—Ä–µ–∂–∏–≤–∞–π—Ç–µ —á–µ—Ä–µ–∑ —Å—Ç–æ–ø–∏ - –≤–æ–Ω–∏ —á–∞—Å—Ç–∏–Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó. –¢—Ä–µ–π–¥–∏–Ω–≥ - —Ü–µ –¥–æ–≤–≥–æ—Å—Ç—Ä–æ–∫–æ–≤–∞ –≥—Ä–∞!":"–ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ —Ç–æ—Ä–≥—É–≤–∞—Ç–∏, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ —Å–≤—ñ–π –ø—Ä–æ–≥—Ä–µ—Å!"}updateSettingsUI(){document.getElementById("risk-input").value=this.gameState.settings.risk_per_position.toString(),document.getElementById("reward-input").value=this.gameState.settings.reward_ratio.toString()}setupEventListeners(){document.getElementById("theme-toggle")?.addEventListener("click",()=>{this.toggleTheme()}),document.getElementById("save-settings").addEventListener("click",async()=>{await this.saveSettings()}),document.getElementById("reset-positions").addEventListener("click",async()=>{await this.resetPositions()}),document.getElementById("show-guide-btn").addEventListener("click",()=>{n.start()}),document.getElementById("start-tutorial").addEventListener("click",()=>{this.hideTutorialModal(),n.start()}),document.getElementById("skip-tutorial").addEventListener("click",()=>{this.hideTutorialModal()}),document.getElementById("skip-forever").addEventListener("click",async()=>{try{await e("/api/settings",{tutorial_skipped_forever:!0}),this.gameState.settings.tutorial_skipped_forever=!0,this.hideTutorialModal(),i("–¢—É—Ç–æ—Ä—ñ–∞–ª –≤—ñ–¥–∫–ª—é—á–µ–Ω–æ –Ω–∞–∑–∞–≤–∂–¥–∏","success")}catch(t){console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —Ç—É—Ç–æ—Ä—ñ–∞–ª—É:",t)}})}async saveSettings(){try{const t=document.getElementById("risk-input"),s=document.getElementById("reward-input"),a=parseFloat(t.value),n=parseFloat(s.value);if(a<.1||a>10)return void i("–†–∏–∑–∏–∫ –º–∞—î –±—É—Ç–∏ –≤—ñ–¥ 0.1% –¥–æ 10%","error");if(n<1||n>5)return void i("–°–ø—ñ–≤–≤—ñ–¥–Ω–æ—à–µ–Ω–Ω—è –ø—Ä–∏–±—É—Ç–∫—É –º–∞—î –±—É—Ç–∏ –≤—ñ–¥ 1 –¥–æ 5","error");await e("/api/settings",{risk_per_position:a,reward_ratio:n}),this.gameState.settings.risk_per_position=a,this.gameState.settings.reward_ratio=n,this.calculateStats(),this.updateStatsDisplay(),i("–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–æ!","success")}catch(t){console.error("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å:",t),i("–ü–æ–º–∏–ª–∫–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å","error")}}async resetPositions(){try{await async function(){const t=await fetch("/api/positions/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}(),this.gameState.positions.forEach(t=>t.result="none"),this.createPositionsGrid(),this.calculateStats(),this.updateStatsDisplay(),i("–í—Å—ñ –ø–æ–∑–∏—Ü—ñ—ó —Å–∫–∏–Ω—É—Ç—ñ!","success")}catch(t){console.error("–ü–æ–º–∏–ª–∫–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ–π:",t),i("–ü–æ–º–∏–ª–∫–∞ —Å–∫–∏–¥–∞–Ω–Ω—è –ø–æ–∑–∏—Ü—ñ–π","error")}}checkTutorial(){this.gameState.settings.tutorial_completed||this.gameState.settings.tutorial_skipped_forever||this.showTutorialModal()}showTutorialModal(){document.getElementById("tutorial-modal").classList.add("show")}hideTutorialModal(){document.getElementById("tutorial-modal").classList.remove("show")}}document.addEventListener("DOMContentLoaded",()=>{(new o).init()})})();
//# sourceMappingURL=bundle.js.map